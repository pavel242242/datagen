{
  "version": "1.0",
  "metadata": {
    "name": "Growth Marketing Campaigns - Multi-Stage Attribution",
    "description": "Marketing campaign journey tracking user progression from ad impression → click → signup → activation → conversion. Integrates vintage effects, segmentation, and multi-stage processes."
  },
  "timeframe": {
    "start": "2024-01-01T00:00:00Z",
    "end": "2024-12-31T23:59:59Z",
    "freq": "h"
  },
  "constraints": {
    "foreign_keys": [
      {"from": "campaign_journey.user_id", "to": "marketing_user.user_id"},
      {"from": "attribution_event.user_id", "to": "marketing_user.user_id"}
    ]
  },
  "nodes": [
    {
      "id": "marketing_user",
      "kind": "entity",
      "pk": "user_id",
      "rows": 1200,
      "segment_behavior": {
        "segment_column": "acquisition_channel",
        "segments": {
          "paid_search": {"base_probability": 0.25},
          "social_media": {"base_probability": 0.35},
          "content_marketing": {"base_probability": 0.20},
          "referral": {"base_probability": 0.15},
          "direct": {"base_probability": 0.05}
        }
      },
      "vintage_behavior": {
        "created_at_column": "first_touch_date",
        "age_based_multipliers": {
          "engagement_decay": {
            "curve": [1.0, 0.98, 0.95, 0.92, 0.89, 0.86, 0.84, 0.82, 0.80, 0.78, 0.77, 0.76],
            "time_unit": "month",
            "applies_to": "fanout"
          }
        }
      },
      "columns": [
        {
          "name": "user_id",
          "type": "int",
          "generator": {"sequence": {"start": 5000, "step": 1}}
        },
        {
          "name": "email",
          "type": "string",
          "generator": {"faker": {"method": "email"}}
        },
        {
          "name": "acquisition_channel",
          "type": "string",
          "generator": {
            "choice": {
              "choices": ["paid_search", "social_media", "content_marketing", "referral", "direct"],
              "weights": [0.25, 0.35, 0.20, 0.15, 0.05]
            }
          }
        },
        {
          "name": "first_touch_date",
          "type": "datetime",
          "generator": {
            "datetime_series": {
              "within": {
                "start": "2024-01-01T00:00:00Z",
                "end": "2024-09-30T23:59:59Z"
              },
              "freq": "h",
              "pattern": {
                "dimension": "dow",
                "weights": [1.1, 1.2, 1.2, 1.2, 1.2, 0.8, 0.6]
              }
            }
          }
        },
        {
          "name": "country",
          "type": "string",
          "generator": {
            "choice": {
              "choices": ["US", "UK", "CA", "AU", "DE"],
              "weights": [0.45, 0.20, 0.15, 0.10, 0.10]
            }
          }
        },
        {
          "name": "utm_campaign",
          "type": "string",
          "generator": {
            "choice": {
              "choices": ["q1_brand", "q2_product", "q3_feature", "q4_holiday", "evergreen"],
              "weights": [0.20, 0.25, 0.25, 0.20, 0.10]
            }
          }
        }
      ]
    },
    {
      "id": "campaign_journey",
      "kind": "fact",
      "pk": "event_id",
      "parents": ["marketing_user"],
      "stage_config": {
        "stages": [
          {"stage_name": "ad_impression", "transition_rate": 1.0},
          {"stage_name": "ad_click", "transition_rate": 0.12},
          {"stage_name": "landing_page_view", "transition_rate": 0.95},
          {"stage_name": "signup_started", "transition_rate": 0.45},
          {"stage_name": "signup_completed", "transition_rate": 0.88},
          {"stage_name": "product_activated", "transition_rate": 0.62},
          {"stage_name": "first_purchase", "transition_rate": 0.55}
        ],
        "segment_variation": {
          "paid_search": {"transition_multiplier": 1.3},
          "referral": {"transition_multiplier": 1.4},
          "social_media": {"transition_multiplier": 0.95},
          "content_marketing": {"transition_multiplier": 1.1},
          "direct": {"transition_multiplier": 1.5}
        }
      },
      "columns": [
        {
          "name": "event_id",
          "type": "int",
          "generator": {"sequence": {"start": 10000, "step": 1}}
        },
        {
          "name": "user_id",
          "type": "int",
          "generator": {"lookup": {"from": "marketing_user.user_id"}}
        },
        {
          "name": "stage_name",
          "type": "string",
          "generator": {"choice": {"choices": ["ad_impression"]}}
        },
        {
          "name": "stage_index",
          "type": "int",
          "generator": {"sequence": {"start": 0, "step": 1}}
        },
        {
          "name": "event_timestamp",
          "type": "datetime",
          "generator": {
            "datetime_series": {
              "within": {
                "start": "2024-01-01T00:00:00Z",
                "end": "2024-12-31T23:59:59Z"
              },
              "freq": "h"
            }
          }
        },
        {
          "name": "device_type",
          "type": "string",
          "generator": {
            "choice": {
              "choices": ["desktop", "mobile", "tablet"],
              "weights": [0.40, 0.50, 0.10]
            }
          }
        },
        {
          "name": "ad_spend_usd",
          "type": "float",
          "generator": {
            "distribution": {
              "type": "lognormal",
              "params": {"mean": 1.5, "sigma": 0.8},
              "clamp": [0.1, 50.0]
            }
          }
        }
      ]
    },
    {
      "id": "attribution_event",
      "kind": "fact",
      "pk": "attribution_id",
      "parents": ["marketing_user"],
      "fanout": {
        "distribution": "poisson",
        "lambda": 8
      },
      "columns": [
        {
          "name": "attribution_id",
          "type": "int",
          "generator": {"sequence": {"start": 50000, "step": 1}}
        },
        {
          "name": "user_id",
          "type": "int",
          "generator": {"lookup": {"from": "marketing_user.user_id"}}
        },
        {
          "name": "touchpoint_timestamp",
          "type": "datetime",
          "generator": {
            "datetime_series": {
              "within": {
                "start": "2024-01-01T00:00:00Z",
                "end": "2024-12-31T23:59:59Z"
              },
              "freq": "h",
              "pattern": {
                "dimension": "hour",
                "weights": [0.3, 0.2, 0.2, 0.2, 0.3, 0.5, 0.8, 1.2, 1.5, 1.8, 1.9, 1.8, 1.7, 1.8, 1.9, 1.7, 1.4, 1.0, 0.8, 0.6, 0.5, 0.4, 0.3, 0.3]
              }
            }
          }
        },
        {
          "name": "touchpoint_type",
          "type": "string",
          "generator": {
            "choice": {
              "choices": ["display_ad", "email", "social_post", "blog_article", "webinar", "demo_video"],
              "weights": [0.30, 0.25, 0.20, 0.15, 0.05, 0.05]
            }
          }
        },
        {
          "name": "revenue_attributed_usd",
          "type": "float",
          "generator": {
            "distribution": {
              "type": "lognormal",
              "params": {"mean": 3.5, "sigma": 1.2},
              "clamp": [0.0, 5000.0]
            }
          }
        }
      ]
    }
  ]
}
