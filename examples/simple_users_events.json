{
  "version": "1.0",
  "metadata": {"name": "SimpleUsersEvents"},
  "timeframe": {
    "start": "2024-01-01T00:00:00Z",
    "end": "2024-03-31T23:59:59Z",
    "freq": "H"
  },
  "nodes": [
    {
      "id": "user",
      "kind": "entity",
      "pk": "user_id",
      "columns": [
        {
          "name": "user_id",
          "type": "int",
          "nullable": false,
          "generator": {"sequence": {"start": 1, "step": 1}}
        },
        {
          "name": "name",
          "type": "string",
          "nullable": false,
          "generator": {"faker": {"method": "name"}}
        },
        {
          "name": "email",
          "type": "string",
          "nullable": false,
          "generator": {"faker": {"method": "email"}}
        },
        {
          "name": "age",
          "type": "int",
          "nullable": false,
          "generator": {
            "distribution": {
              "type": "normal",
              "params": {"mean": 35, "std": 12},
              "clamp": [18, 80]
            }
          }
        }
      ]
    },
    {
      "id": "event",
      "kind": "fact",
      "parents": ["user"],
      "pk": "event_id",
      "fanout": {
        "distribution": "poisson",
        "lambda": 8,
        "min": 0,
        "max": 50
      },
      "columns": [
        {
          "name": "event_id",
          "type": "int",
          "nullable": false,
          "generator": {"sequence": {"start": 1, "step": 1}}
        },
        {
          "name": "user_id",
          "type": "int",
          "nullable": false,
          "generator": {"lookup": {"from": "user.user_id"}}
        },
        {
          "name": "timestamp",
          "type": "datetime",
          "nullable": false,
          "generator": {
            "datetime_series": {
              "within": "timeframe",
              "freq": "H",
              "pattern": {
                "dimension": "dow",
                "weights": [0.9, 1.0, 1.0, 1.1, 1.3, 1.2, 0.8]
              }
            }
          }
        },
        {
          "name": "amount",
          "type": "float",
          "nullable": false,
          "generator": {
            "distribution": {
              "type": "lognormal",
              "params": {"mean": 3.5, "sigma": 0.8},
              "clamp": [5, 1000]
            }
          }
        }
      ]
    }
  ],
  "constraints": {
    "unique": ["user.user_id", "event.event_id"],
    "foreign_keys": [
      {"from": "event.user_id", "to": "user.user_id"}
    ],
    "ranges": [
      {"attr": "user.age", "min": 18, "max": 80},
      {"attr": "event.amount", "min": 5, "max": 1000}
    ]
  },
  "targets": {
    "weekend_share": {
      "table": "event",
      "timestamp": "timestamp",
      "min": 0.30,
      "max": 0.45
    }
  }
}
